<!--
SPDX-FileCopyrightText: GTK Development Team

SPDX-License-Identifier: LGPL-2.1-or-later
-->

<!DOCTYPE html>
<html lang="en">
<head>
  <title>Gtk &ndash; 3.0: Changes in GTK 3</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta charset="utf-8" />

  
  <meta property="og:type" content="website"/>

  
  <meta property="og:image:width" content="256"/>
  <meta property="og:image:height" content="256"/>
  <meta property="og:image:secure_url" content="gtk-logo.svg"/>
  <meta property="og:image:alt" content="Gtk-3.0"/>
  

  
  <meta property="og:title" content="Gtk: Changes in GTK 3"/>
  <meta property="og:description" content="Reference for Gtk-3.0: Changes in GTK 3"/>
  <meta name="twitter:title" content="Gtk: Changes in GTK 3"/>
  <meta name="twitter:description" content="Reference for Gtk-3.0: Changes in GTK 3"/>


  
  <meta name="twitter:card" content="summary"/>

  
  
  
  <link rel="search" type="application/opensearchdescription+xml" title="Gtk" href="opensearch.xml">
  
  

  <link rel="stylesheet" href="style.css" type="text/css" />

  

  
  <script src="urlmap.js"></script>
  
  
  <script src="fzy.js"></script>
  <script src="search.js"></script>
  
  <script src="main.js"></script>

  
</head>

<body>
  <div id="body-wrapper" tabindex="-1">

    <nav class="sidebar devhelp-hidden">
      
      <div class="section">
        <a href="index.html"><img src="gtk-logo.svg" class="logo"/></a>
      </div>
      
      
      <div class="search section">
        <form id="search-form" autocomplete="off">
          <input id="search-input" type="text" name="do-not-autocomplete" placeholder="Click, or press 's' to search" autocomplete="off"/>
        </form>
      </div>
      
      <div class="section namespace">
        <h3><a href="index.html">Gtk</a></h3>
        <p>API Version: 3.0</p>
        
        <p>Library Version: 3.24</p>
        
      </div>
      
      
      <div class="section generator">
        <p>Generated by <a href="https://gitlab.gnome.org/GNOME/gi-docgen">gi-docgen</a> 2024.2</p>
      </div>
    </nav>

    <button id="btn-to-top" class="hidden"><span class="up-arrow"></span></button>

    
<section id="main" class="content">
  
  <h4 id="title" style="display:flex;">
    Changes in GTK 3
    <a href="changes.html#title" class="anchor"></a>
    
  </h4>
  
  <section>
    <div class="docblock">
    <h1 id="changes-in-gtk-3">Changes in GTK 3<a class="md-anchor" href="changes.html#changes-in-gtk-3" title="Permanent link"></a></h1>
<p><span class="caps">GTK</span> 3 has seen considerable development over multiple stable releases. While
we try to maintain compatibility as far as possible, some minor adjustments
may be necessary when moving an application from one release of <span class="caps">GTK</span> 3 to
the&nbsp;next.</p>
<p>The following sections list noteworthy changes in <span class="caps">GTK</span> 3.x release that may
or may not require applications to be&nbsp;updated. </p>
<h2 id="changes-in-gtk-32">Changes in GTK 3.2<a class="md-anchor" href="changes.html#changes-in-gtk-32" title="Permanent link"></a></h2>
<p>The accessible implementations for <span class="caps">GTK</span> widgets have been integrated into
libgtk itself, and the gail module does not exist anymore. This change
should not affect applications very&nbsp;much.</p>
<h2 id="changes-in-gtk-34">Changes in GTK 3.4<a class="md-anchor" href="changes.html#changes-in-gtk-34" title="Permanent link"></a></h2>
<p>Scroll events have been separated from button events, and smooth scrolling
has been added with a separate event mask. Widgets now need to have either
<code>GDK_SCROLL_MASK</code> or <code>GDK_SMOOTH_SCROLL_MASK</code> in their event mask to receive
scroll events. In addition, the <code>GdkScrollDirection</code> enumeration has gained
a new member, <code>GDK_SCROLL_SMOOTH</code>, so switch statements will have to be
amended to cover this&nbsp;case.</p>
<p><span class="caps">GTK</span> now uses <code>&lt;Primary&gt;</code> instead of <code>&lt;Control&gt;</code> in keyboard accelerators,
for improved cross-platform handling. This should not affect applications,
unless they parse or create these accelerator&nbsp;manually.</p>
<p>The tacit assumption that the <kbd>Alt</kbd> key corresponds to the <code>MOD1</code>
modifier under X11 is now a hard&nbsp;requirement.</p>
<p>The Beagle search backend for the file chooser has been dropped.
<a href="https://gnome.pages.gitlab.gnome.org/tracker/">Tracker</a> is the only
supported search backend on Linux&nbsp;now.</p>
<p><code>GtkNotebook</code> has been changed to destroy its action widgets when it gets
destroyed itself. If your application is using action widgets in notebooks,
you may have to adjust your code to take this into&nbsp;account.</p>
<p><code>GtkApplication</code> no longer uses the <code>gtk_</code> mainloop wrappers, so it is no
longer possible to use <code>gtk_main_quit()</code> to stop&nbsp;it.</p>
<p>The <code>-uninstalled</code> variants of the pkg-config files have been&nbsp;dropped.</p>
<p>Excessive dependencies have been culled from <code>Requires:</code> lines in the
pkg-config files. Dependent modules may have to declare dependencies that
there were getting &#8216;for free&#8217; in the&nbsp;past.</p>
<h2 id="changes-in-gtk-36">Changes in GTK 3.6<a class="md-anchor" href="changes.html#changes-in-gtk-36" title="Permanent link"></a></h2>
<p>The accessibility bridge code that exports accessible objects on the bus is
now used by default; atk-bridge has been converted into a library that <span class="caps">GTK</span>
links against. To void the linking, pass &#8212;without-atk-bridge when
configuring <span class="caps">GTK</span>.</p>
<p><span class="caps">GDK</span> threading support has been deprecated. It is recommended to use
<code>g_idle_add()</code>, <code>g_main_context_invoke()</code> and similar funtions to make all <span class="caps">GTK</span>
calls from the main&nbsp;thread.</p>
<p><span class="caps">GTK</span> now follows the <a href="https://specifications.freedesktop.org/basedir-spec/latest/"><span class="caps">XDG</span> Base
Directory</a>
specification for user configuration and data files. In&nbsp;detail,</p>
<ul>
<li><code>$XDG_CONFIG_HOME/gtk-3.0/custom-papers</code> is the new location for
  <code>$HOME/.gtk-custom-papers</code></li>
<li><code>$XDG_CONFIG_HOME/gtk-3.0/bookmarks</code> is the new location for
  <code>$HOME/.gtk-bookmarks</code></li>
<li><code>$XDG_DATA_HOME/themes</code> is preferred over <code>$HOME/.themes</code></li>
<li><code>$XDG_DATA_HOME/icons</code> is preferred over <code>$HOME/.icons</code>.</li>
</ul>
<p>Existing files from the old location will still be read if the new location
does not&nbsp;exist.</p>
<p><code>$HOME/.gtk-3.0</code> is no longer in the default module load path. If you want
to load modules from there, add it to the <code>GTK_PATH</code> environment&nbsp;variable.</p>
<h2 id="changes-in-gtk-38">Changes in GTK 3.8<a class="md-anchor" href="changes.html#changes-in-gtk-38" title="Permanent link"></a></h2>
<p><code>GtkIconInfo</code> has changed from being a boxed type to a <code>GObject</code>. This is
technically an <span class="caps">ABI</span> change, but basically all existing code will keep working
if its used as a boxed type, and it is not possible to instantiate
<code>GtkIconInfo</code>s outside <span class="caps">GTK</span>, so this is not expected to be a big&nbsp;problem.</p>
<h2 id="changes-in-gtk-310">Changes in GTK 3.10<a class="md-anchor" href="changes.html#changes-in-gtk-310" title="Permanent link"></a></h2>
<p><span class="caps">GDK</span> has been changed to allow only a single &#8220;screen&#8221; per display. Only the
X11 backend had multiple screens before, and multi-screen setups (not
multi-monitor!) are very rare nowadays. If you really need multiple X
screens, open them as separate&nbsp;displays.</p>
<p>The behavior of the [<code>GtkBox:expand</code>] child property has been changed to
never propagate up. Previously, this was happening inconsistently. If you
want the expand to propagate, use the GtkWidget h/vexpand properties. If
you experience sizing problems with widgets in ported code, carefully check
the expand and fill flags of your&nbsp;boxes.</p>
<p><code>GtkBin</code> no longer provides default implementations for
<code>get_height_for_width</code>, subclasses now have to provide their own
implementation if they need height-for-width&nbsp;functionality.</p>
<p>Widget state propagation has been changed. Historically, all of active,
prelight, selected, insensitive, inconsistent and backdrop have been
propagated to children. This has now been restricted to just the insensitive
and backdrop states. This mostly affects&nbsp;theming.</p>
<p>The way widget drawing happens has changed. Earlier versions handled one
expose event per <code>GdkWindow</code>, each with a separate <code>cairo_t</code>. Now we only
handle the expose event on the toplevel and reuse the same <code>cairo_t</code> (with
the right translation and clipping) for the entire widget hierarchy,
recursing down via the <a href="signal.Widget.draw.html"><code>GtkWidget::draw</code></a> signal. Having all
rendering in the same call tree allows effects like opacity and offscreen
rendering of entire widget sub-hierarchies. Generally this should not
require any changes in widgets, but code looking at e.g. the current expose
event may see different behavior than&nbsp;before.</p>
<p>The <span class="caps">GTK</span> scrolling implementation has changed. <a href="javascript:void(0)" data-namespace="Gdk" data-link="method.Window.scroll.html" class="external"><code>gdk_window_scroll()</code></a>
and <a href="javascript:void(0)" data-namespace="Gdk" data-link="method.Window.move_region.html" class="external"><code>gdk_window_move_region()</code></a> no longer copy the region on the
window, but rather invalidate the entire scrolled region. This is slightly
slower, but allowed us to implement a offscreen surface scrolling method
which better fits modern hardware. Most scrolling widgets in <span class="caps">GTK</span> have been
converted to use this model for scrolling, but external widgets implementing
scrolling using <code>GdkWindow</code> may see some&nbsp;slowdown.</p>
<h2 id="changes-in-gtk-312">Changes in GTK 3.12<a class="md-anchor" href="changes.html#changes-in-gtk-312" title="Permanent link"></a></h2>
<p><code>GtkWidget</code> had a hack where if opacity is 0.999 we set up an opacity group
when rendering the widget. This is no longer needed in 3.10, and <code>GtkStack</code>
doesn&#8217;t use it anymore. It has been removed in 3.12. <code>GdStack</code> is using it,
so applications should be ported from <code>GdStack</code> to <code>GtkStack</code> in&nbsp;3.12.</p>
<p><code>GtkHeaderBar</code> in 3.10 was not ordering its pack-end children in the right
way. This has been fixed in 3.12. Applications which pack multiple widgets
at the end of a headerbar will have to be&nbsp;updated.</p>
<p><a href="method.TextView.add_child_in_window.html"><code>gtk_text_view_add_child_in_window()</code></a> has changed behaviour a bit. It
now always positions the child in buffer coordinates, where it used to
inconsistently scroll with the buffer but then go reposition to a
window-relative position on&nbsp;redraw.</p>
<p>A number of container widgets have been made more compliant with the uniform
<span class="caps">CSS</span> rendering model by making them render backgrounds and borders. This may
require some adjustments in applications that were making assumptions about
containers never rendering&nbsp;backgrounds.</p>
<h2 id="changes-in-gtk-314">Changes in GTK 3.14<a class="md-anchor" href="changes.html#changes-in-gtk-314" title="Permanent link"></a></h2>
<p>A new state, <code>GTK_STATE_FLAG_CHECKED</code>, has been added for checked states of
radio and check buttons and menuitems. Applications that are using <span class="caps">GTK</span>
styles without widgets will need&nbsp;adjustments.</p>
<p>Adwaita is now the default theme on all&nbsp;platforms.</p>
<p>The icon theme code has become a little pickier about sizes and is not
automatically scaling icons beyond the limits defined in the icon theme
unless explicitly asked to do so with <code>GTK_ICON_LOOKUP_FORCE_SIZE</code>.</p>
<p><span class="caps">GTK</span> now includes an interactive debugger which can be activated with the
keyboard shortcuts <kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>D</kbd> or
<kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>I</kbd>. If these shortcuts interfere
with application keybindings, they can be disabled with the
<code>enable-inspector-keybinding</code> setting in the <code>org.gtk.Settings.Debug</code>
GSettings&nbsp;schema.</p>
<p>Most widgets have been ported to use the new gesture framework internally
for event handling. Traditional event handlers in derived widgets are still
being&nbsp;called.</p>
<p>Using <span class="caps">GTK</span> under X11 without the X Render extension has been observed to be
problematic. This combination is using code paths in Cairo and graphics
drivers which are rarely tested and likely&nbsp;buggy.</p>
<p><code>GtkTextView</code> is now using a pixel-cache internally, and is drawing a
background underneath the text. This can cause problems for applications
which assumed that they could draw things below and above the text by
chaining up in the <code>::draw</code> implementation of their <code>GtkTextView</code> subclass.
As a short-term workaround, you can make the application apply a custom
theme to the text view with a transparent background. For a proper fix, use
the new <code>::draw_layer</code> vfunc.</p>
<h2 id="changes-in-gtk-316">Changes in GTK 3.16<a class="md-anchor" href="changes.html#changes-in-gtk-316" title="Permanent link"></a></h2>
<p><span class="caps">GTK</span> now includes an OpenGL rendering widget. To support <span class="caps">GL</span> on various
platforms, <span class="caps">GTK</span> uses <a href="https://github.com/anholt/libepoxy">libepoxy</a>.</p>
<p><span class="caps">GTK</span> no longer uses <code>gtk-update-icon-cache</code> during its build. The
<code>--enable-gtk2-dependency</code> configure option has been&nbsp;removed.</p>
<p>The introspection annotations for the x and y parameters of
<code>GtkMenuPositionFunc</code> have been corrected from &#8216;out&#8217; to &#8216;inout&#8217;. If you are
using such a function from language-bindings, this may require&nbsp;adjustments.</p>
<p>The lookup order for actions that are activated via keyboard accelerators
has been changed to start at the currently focused widget. If your
application is making use fo nested action groups via
<code>gtk_widget_insert_action_group()</code>, you may want to check that this change
does not upset your&nbsp;accelerators.</p>
<p>The <code>GtkScrollable</code> interface has gained a new vfunc, <code>get_border()</code>, that
is used to position overshoot and undershoot indications that are drawn over
the content by <code>GtkScrolledWindow</code>. Unless your scrollable has non-scrolling
parts similar to treeview headers, there is no need to implement this&nbsp;vfunc.</p>
<p>The <code>GtkSearchEntry</code> widget has gained a number of new signals that are
emitted when certain key sequences are seen. In particular, it now handles
the <kbd>Esc</kbd> key and emits <code>::stop-search</code>. Applications that expect
to handle <kbd>Esc</kbd> themselves will need to be&nbsp;updated.</p>
<h2 id="changes-in-gtk-318">Changes in GTK 3.18<a class="md-anchor" href="changes.html#changes-in-gtk-318" title="Permanent link"></a></h2>
<p>The GtkListBox model support that was introduced in 3.16 has been changed to
no longer call <code>gtk_widget_show_all()</code> on rows created by the
<code>create_widget_func</code>. You need to manage the visibility of child widgets
yourself in your <code>create_widget_func</code>.</p>
<p>The alpha component of foreground colors that are applied to
<code>GtkCellRendererText</code> is no longer ignored. If you don&#8217;t want your text to be
translucent, use opaque&nbsp;colors.</p>
<h2 id="changes-in-gtk-320">Changes in GTK 3.20<a class="md-anchor" href="changes.html#changes-in-gtk-320" title="Permanent link"></a></h2>
<p>The way theming works in <span class="caps">GTK</span> has been reworked fundamentally, to implement
many more <span class="caps">CSS</span> features and make themes more expressive. As a result, custom
<span class="caps">CSS</span> that is shipped with applications and third-party themes will need
adjustments. Widgets now use element names much more than style classes;
type names are no longer used in style matching. Every widget now documents
the element names it has and the style classes it uses. The <span class="caps">GTK</span> inspector
can also help with finding this&nbsp;information.</p>
<p><span class="caps">GTK</span> now uses internal subobjects (also known as gadgets) for allocating and
drawing widget parts. Applications that subclass <span class="caps">GTK</span> widgets may see
warnings if they override the <code>size_allocate</code> vfunc and don&#8217;t chain up. The
proper way to subclass is to chain up in <code>size_allocate</code>. If you do not want
to do that for some reason, you have to override the <code>draw</code> vfunc as&nbsp;well.</p>
<p>Several fixes for window sizing and window placement with client-side
decorations may affect applications that are saving and restoring window
sizes. The recommended best practice for this which is known to work with
client-side and server-side decorations and with older and newer versions of
<span class="caps">GTK</span> is to use <code>gtk_window_get_size()</code> to save window sizes and
<code>gtk_window_set_default_size()</code> to restore it. See
<a href="https://wiki.gnome.org/HowDoI/SaveWindowState">https://wiki.gnome.org/HowDoI/SaveWindowState</a> for a detailed&nbsp;example.</p>
<p>Geometry handling in <code>GtkWindow</code> has been removed. If you are using the
functions <code>gtk_window_resize_to_geometry()</code>,
<code>gtk_window_set_default_geometry()</code>, <code>gtk_window_parse_geometry()</code> or
<code>gtk_window_set_geometry_hints()</code>, you may need to make some changes to your&nbsp;code.</p>
<p><code>GtkDrawingArea</code> used to implicitly render the theme background before
calling the <code>::draw</code> handler. This is no longer the case. If you rely on
having a theme-provided background, call <code>gtk_render_background()</code> from your
<code>::draw</code> handler.</p>
<p>The <code>GtkFileChooser</code> interface prerequisite changed from <code>GtkWidget</code> to
<code>GObject</code>, allowing non-widget implementations of this interface. This is a
minor change in <span class="caps">ABI</span>, as applications are no longer guaranteed that a
<code>GtkFileChooser</code> also supports all <code>GtkWidget</code> methods. However, all
previously existing implementations still derive from <code>GtkWidget</code>, so no
existing code should&nbsp;break.</p>
<p>The way in which <code>GtkLevelBar</code> determines the offset to apply was a bit
inconsistent in the past; this has been fixed. Applications that are using
custom offsets should double-check that their levels look as&nbsp;expected.</p>
<h2 id="changes-in-gtk-322">Changes in GTK 3.22<a class="md-anchor" href="changes.html#changes-in-gtk-322" title="Permanent link"></a></h2>
<p>The <span class="caps">CSS</span> parser has gotten a bit more selective in what it accepts as valid
values for the <code>font:</code> shorthand property. Following the <span class="caps">CSS</span> specification,
at least a size and a family name are required now. If you want to change an
individual facet of the font, like the weight, use the individual <span class="caps">CSS</span>
properties: <code>font-weight</code>, <code>font-size</code>, <code>font-family</code>,&nbsp;etc.</p>
<p>The <span class="caps">CSS</span> parser now warns about some more constructs that are not according
to the <span class="caps">CSS</span> spec, such as gradients with a single color stop. Instead, you
can just use <code>image(&lt;color&gt;)</code>.</p>
<p>The “ignore-hidden” property has not been working properly for a long time,
and we&#8217;ve not documented it as broken and deprecated. The recommended
alternative for reserving space of widgets that are not currently shown in
the <span class="caps">UI</span> is to use a <code>GtkStack</code> (with some &#8216;filler&#8217; widget, e.g. an empty
<code>GtkBox</code>, in another&nbsp;page).</p>
<p><code>GtkHeaderBar</code> now respects the hexpand property for its custom title widget
and its packed children. This change may inadvertently cause the layout of
those children to change, if they unintentionally had hexpand set&nbsp;before.</p>
<p>The behavior of the expand flag in <code>GtkTable</code><span class="quo">&#8216;</span>s <code>GtkAttachOptions</code> has been
changed to (again) match the behavior in <code>GtkBox</code> and in <span class="caps">GTK</span> 2.x. These
options don&#8217;t cause the table itself to&nbsp;expand.</p>
<p>The way <code>GtkPopover</code> behaved during a call to <code>gtk_widget_hide()</code> violated
some of the internal assumptions <span class="caps">GTK</span> makes about widget visibility.
<code>gtk_popover_popup()</code> and <code>gtk_popover_popdown()</code> have been introduced to
show or hide the popover with a transition, while <code>gtk_widget_show()</code> and
<code>gtk_widget_hide()</code> on a GtkPopover now work the same way they do on any
other widget and immediately hide (or show) the&nbsp;popover.</p>
    </div>
  </section>
</section>


    
<div id="toc" class="toc">
  <nav aria-labelledby="toc-title">
    <p id="toc-title">Content</p>
    <ul class="toc-list">
      
        
        <li class="toc-list-item"><a href="changes.html#changes-in-gtk-32"><span class="link-text">Changes in GTK 3.2</span></a></li>
        
        <li class="toc-list-item"><a href="changes.html#changes-in-gtk-34"><span class="link-text">Changes in GTK 3.4</span></a></li>
        
        <li class="toc-list-item"><a href="changes.html#changes-in-gtk-36"><span class="link-text">Changes in GTK 3.6</span></a></li>
        
        <li class="toc-list-item"><a href="changes.html#changes-in-gtk-38"><span class="link-text">Changes in GTK 3.8</span></a></li>
        
        <li class="toc-list-item"><a href="changes.html#changes-in-gtk-310"><span class="link-text">Changes in GTK 3.10</span></a></li>
        
        <li class="toc-list-item"><a href="changes.html#changes-in-gtk-312"><span class="link-text">Changes in GTK 3.12</span></a></li>
        
        <li class="toc-list-item"><a href="changes.html#changes-in-gtk-314"><span class="link-text">Changes in GTK 3.14</span></a></li>
        
        <li class="toc-list-item"><a href="changes.html#changes-in-gtk-316"><span class="link-text">Changes in GTK 3.16</span></a></li>
        
        <li class="toc-list-item"><a href="changes.html#changes-in-gtk-318"><span class="link-text">Changes in GTK 3.18</span></a></li>
        
        <li class="toc-list-item"><a href="changes.html#changes-in-gtk-320"><span class="link-text">Changes in GTK 3.20</span></a></li>
        
        <li class="toc-list-item"><a href="changes.html#changes-in-gtk-322"><span class="link-text">Changes in GTK 3.22</span></a></li>
        
      
    </ul>
  </nav>
</div>


    <section id="search" class="content hidden"></section>

    <footer>
    
    </footer>
  </div>
</body>
</html>